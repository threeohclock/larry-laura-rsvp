{% extends "base.html" %}

{% block title %}Please fill us in on your trip details{% endblock %}

{% block ExtraHeaders %}
<script src="/js/autoresize.jquery.min.js" type="text/javascript"></script>
{% endblock %}

{% block ExtraJavascript %}
function SetButtons() {
  {% if roomnumber %}$( "#room{{ roomnumber }}" ).attr("selected", true);{% endif %}
  $( '#tripdetail_form' ).submit(ValidateForm);
  $( '#notesfield' ).autoResize(){% if notes %}.trigger('change');{% endif %};
};

function ValidateForm() {
  roomnum = $("#roomnumber").find(':selected').val();
  if (!roomnum) {
    ShowError('Please select a room (or "Staying elsewhere") from the room number menu.');
    return false;
  }
  if (roomnum == 21) {
    ShowError('That\'s MY room, you cheeky bastard!');
    return false;
  }
};


{% endblock %}

{% block OnLoad %}
{{ block.super }}
  SetupAutoResize(jQuery)
  SetButtons();
{% endblock %}

{% block content %}
<p>Please tell us some details about your trip.
  <form action="/tripdetail" id="tripdetail_form" method="post">
    <div id="hotelfields">
      Your <a href="http://www.larryandlaura.us/ana-y-jose" target="_blank">Ana y Jos&eacute;</a> room number and name
      <select id="roomnumber" name="roomnumber">
        {% if not roomnumber %}<option selected></option>{% endif %}
        {% for room in rooms.items %}
          <option value="{{ room.0 }}" id="room{{ room.0 }}">{% if room.0 %}{{ room.0 }} - {% endif %}{{ room.1 }}</option>
        {% endfor %}
      </select>
      <div id="notesinput">
        Please enter any additional notes, especially food allergies or other concerns:<br />
        <textarea id="notesfield" name="notes">{% if notes %}{{ notes }}{% endif %}</textarea>
      </div>
    </div>
   <input id="tripsubmit" type="submit" value="Submit RSVP" />
  </form>
</p>
{% endblock %}
